(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{339:(e,t,s)=>{Promise.resolve().then(s.bind(s,9325))},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},9325:(e,t,s)=>{"use strict";s.d(t,{default:()=>u});var a=s(5155),r=s(2115),l=s(3464),o=s(5695),n=s(9576);let u=()=>{let[e,t]=(0,r.useState)(""),[s,u]=(0,r.useState)(""),[i,c]=(0,r.useState)(""),d=(0,o.useRouter)(),{login:m}=(0,n.A)(),h=async t=>{t.preventDefault();try{let{data:t}=await l.A.post("/api/auth/login",{email:e,password:s});if("admin"!==t.user.role)return void c("Access denied. You are not an admin.");console.log(t),m(t.token),d.push("/")}catch(e){var a,r;c((null==(r=e.response)||null==(a=r.data)?void 0:a.message)||"Login failed")}};return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[#0a0f29] text-white px-4",children:(0,a.jsxs)("form",{onSubmit:h,className:"bg-black/80 backdrop-blur-lg p-8 rounded-xl shadow-lg w-full max-w-md",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-center mb-6 text-yellow-400",children:"Admin Login"}),i&&(0,a.jsx)("p",{className:"text-red-400 text-sm text-center mb-4",children:i}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block mb-1 text-sm",children:"Email"}),(0,a.jsx)("input",{type:"email",className:"w-full p-2 rounded bg-white/10 border border-white/20 text-white focus:outline-none",value:e,onChange:e=>t(e.target.value),required:!0,autoFocus:!0})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block mb-1 text-sm",children:"Password"}),(0,a.jsx)("input",{type:"password",className:"w-full p-2 rounded bg-white/10 border border-white/20 text-white focus:outline-none",value:s,onChange:e=>u(e.target.value),required:!0})]}),(0,a.jsx)("button",{type:"submit",className:"w-full bg-yellow-500 hover:bg-yellow-600 text-black py-2 rounded font-semibold transition",children:"Login"})]})})}},9576:(e,t,s)=>{"use strict";s.d(t,{A:()=>u,AuthProvider:()=>n});var a=s(5155),r=s(2115),l=s(3464);let o=(0,r.createContext)(void 0),n=e=>{let{children:t}=e,[s,n]=(0,r.useState)(!1),[u,i]=(0,r.useState)(0),c=async()=>{try{let e=localStorage.getItem("token");if(!e)return;let t=(await l.A.get("/api/messages",{headers:{Authorization:"Bearer ".concat(e)}})).data.filter(e=>!e.hasViewed).length;i(t)}catch(e){console.error("Failed to fetch unseen messages")}};return(0,r.useEffect)(()=>{n(!!localStorage.getItem("token"))},[]),(0,r.useEffect)(()=>{s&&c()},[s]),(0,a.jsx)(o.Provider,{value:{isLoggedIn:s,unseenCount:u,login:e=>{localStorage.setItem("token",e),n(!0),c()},logout:()=>{localStorage.clear(),n(!1),i(0)},fetchUnseenCount:c},children:t})},u=()=>{let e=(0,r.useContext)(o);if(!e)throw Error("useAuth must be used inside an AuthProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[464,441,684,120],()=>t(339)),_N_E=e.O()}]);